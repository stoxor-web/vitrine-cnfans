<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Admin Produits CNFANS</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
    h1 { text-align: center; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #fff; }
    th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
    input[type="text"], input[type="number"], select { width: 100%; padding: 5px; }
    button { margin: 5px; padding: 6px 12px; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
</head>
<body>
  <header><h1>üõ†Ô∏è Interface Admin ‚Äì Produits CNFANS</h1></header>

  <input type="file" id="fileInput" accept=".json"><br><br>
  <button onclick="addProduct()">‚ûï Ajouter un produit</button>
  <button onclick="downloadJSON()">üíæ T√©l√©charger JSON</button>

  <table id="productTable">
    <thead>
      <tr>
        <th>Titre</th><th>Plateforme</th><th>ID</th><th>Image</th>
        <th>Cat√©gorie</th><th>Marque</th><th>Prix (‚Ç¨)</th><th>Actions</th>
      </tr>
    </thead>
    <tbody id="productTableBody"></tbody>
  </table>

  <script>
    let products = [];

    document.getElementById('fileInput').addEventListener('change', function(e) {
      const reader = new FileReader();
      reader.onload = () => { products = JSON.parse(reader.result); renderTable(); enableDragAndDrop(); };
      reader.readAsText(e.target.files[0]);
    });

    function renderTable() {
      const tbody = document.getElementById('productTableBody');
      tbody.innerHTML = '';
      products.forEach((p,i) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td><input value="${p.title}" onchange="products[${i}].title=this.value"></td>
          <td><input value="${p.platform}" onchange="products[${i}].platform=this.value"></td>
          <td><input value="${p.id}" onchange="products[${i}].id=this.value"></td>
          <td><input value="${p.image}" onchange="products[${i}].image=this.value"></td>
          <td>
            <select onchange="products[${i}].category=this.value">
              <option>Mode Homme</option>
              <option>Mode Femme</option>
              <option>Accessoires</option>
              <option>Chaussures</option>
            </select>
          </td>
          <td>
            <select onchange="products[${i}].brand=this.value">
              <option>Adidas</option>
              <option>Ami</option>
              <option>Apple</option>
              <option>Arc'teryx</option>
              <option>Asics</option>
              <option>Balenciaga</option>
              <option>Birkenstock</option>
              <option>Burberry</option>
              <option>C.P Company</option>
              <option>Calvin Klein</option>
              <option>Carhartt</option>
              <option>Coach</option>
              <option>Corteiz</option>
              <option>Diesel</option>
              <option>Dior</option>
              <option>DR Martens</option>
              <option>Enfants</option>
              <option>Essentials</option>
              <option>Fred Perry</option>
              <option>G-Shock</option>
              <option>Gallery Dept</option>
              <option>Golden Goose</option>
              <option>Goyard</option>
              <option>Gucci</option>
              <option>Herm√®s</option>
              <option>Jacquemus</option>
              <option>K-Way</option>
              <option>Kaws</option>
              <option>Lacoste</option>
              <option>Lanvin</option>
              <option>Lego</option>
              <option>Louis Vuitton</option>
              <option>Moncler</option>
              <option>Mont Blanc</option>
              <option>New Balance</option>
              <option>New Era</option>
              <option>Nike</option>
              <option>Oakley</option>
              <option>Others</option>
              <option>Palace</option>
              <option>Pokemon</option>
              <option>Ralph Lauren</option>
              <option>Rolex</option>
              <option>Salomon</option>
              <option>Seiko</option>
              <option>Stone Island</option>
              <option>Stussy</option>
              <option>Supreme</option>
              <option>The North Face</option>
              <option>Thom Browne</option>
              <option>Tissot</option>
              <option>Ugg</option>
              <option>Under Armour</option>
              <option>Van Cleef</option>
              <option>Veja</option>
              <option>Venum</option>
              <option>Yeezy</option>
              <option>Yves Saint Laurent</option>
            </select>
          </td>
          <td><input type="number" value="${p.price}" onchange="products[${i}].price=parseFloat(this.value)" step="0.01"></td>
          <td><button onclick="deleteProduct(${i})">üóë Supprimer</button></td>
        `;
        tbody.appendChild(row);
      });
    }

    function enableDragAndDrop() {
      new Sortable(document.getElementById('productTableBody'), {
        animation:150,
        onEnd: evt => {
          const [moved] = products.splice(evt.oldIndex,1);
          products.splice(evt.newIndex,0,moved);
        }
      });
    }

    function addProduct() {
      products.push({title:"",platform:"",id:"",image:"",category:"Mode Homme",brand:"Nike",price:0,cnfans_link:"",source:""});
      renderTable();
    }
    function deleteProduct(i) {
      products.splice(i,1); renderTable();
    }
    function downloadJSON() {
      products.forEach(p=>{
        p.cnfans_link=`https://cnfans.com/product?platform=${p.platform}&id=${p.id}&ref=212491`;
        p.source=`https://www.cnfans.com/product?id=${p.id}&platform=${p.platform}`;
      });
      const blob=new Blob([JSON.stringify(products,null,2)],{type:'application/json'});
      const a=document.createElement('a'); a.href=URL.createObjectURL(blob);
      a.download='jadeship_products.json'; a.click();
    }
  </script>
</body>
</html>
