<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>TRENDY WORLD SHOP</title>
  <style>
    :root {
      --marquee-duration: 45s;
      --marquee-gap: 100px;
    }
    /* Reset link underline */
    a { text-decoration: none !important; color: inherit; }
    html, body { overflow-x: hidden; margin: 0; padding: 0; width: 100%; }
    body { font-family: Arial, sans-serif; background: #f2f2f2; }
    header { background-color: #111827; color: white; padding: 20px; text-align: center; position: relative; }
    .admin-link { position: absolute; top:5px; left:5px; font-size:24px; color:white; }
    .admin-link:hover { color:#007bff; }

    /* Marquee */
    .marquee {
      background: red;
      overflow: hidden;
      white-space: nowrap;
    }
    .marquee .msg {
      display: inline-block;
      padding-left: 100%;
      margin-right: var(--marquee-gap);
      animation: scroll var(--marquee-duration) linear infinite;
      color: white;
      font-size: 14px;
      font-weight: bold;
    }
    @keyframes scroll {
      from { transform: translateX(0); }
      to   { transform: translateX(-100%); }
    }

    .filters { text-align:center; padding:20px; }
    .filters select {
      padding:12px 20px;
      font-size:16px;
      border-radius:25px;
      border:2px solid #ddd;
      margin:0 10px 20px;
      transition:.3s;
    }
    .filters select:hover { border-color:#007bff; background:#f0f8ff; }

    .grid {
      display:grid;
      grid-template-columns: repeat(auto-fill,minmax(240px,1fr));
      gap:20px;
      padding:20px;
      max-width:1200px;
      margin:auto;
    }
    .product {
      background:#fff;
      border-radius:10px;
      overflow:hidden;
      box-shadow:0 2px 10px rgba(0,0,0,.05);
      text-align:center;
      transition:transform .2s ease;
      position: relative;
    }
    .product:hover { transform:translateY(-5px); }

    /* Nouvelle vignette de marque */
    .product-brand {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.6);
      color: #fff;
      padding: 3px 8px;
      font-size: 12px;
      font-weight: bold;
      border-radius: 4px;
    }

    .product img {
      width:100%;
      height:220px;
      object-fit:contain;
    }
    .product-title { padding:10px; font-size:16px; font-weight:bold; color:#333; }
    .product-price { padding:10px; font-size:16px; font-weight:bold; color:#000; }
    .product-colors { padding:5px 0; }
    .color-circle {
      display:inline-block;
      width:14px;
      height:14px;
      border-radius:50%;
      margin:0 3px;
      border:1px solid #ccc;
    }
    .social-banner {
      background:#808080;
      text-align:center;
      padding:10px 0;
    }
    .social-banner a img {
      width:40px; height:40px; margin:0 10px; vertical-align:middle;
    }

    @media(max-width:768px) {
      .grid { grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:15px; }
      .product-title{font-size:14px;}
      .product-price{font-size:12px;}
    }
    @media(max-width:480px) {
      .grid{grid-template-columns:1fr;gap:10px;}
      .filters select{width:160px;margin-bottom:15px;}
    }
  </style>
</head>
<body>

  <header>
    <h1>TRENDY WORLD SHOP</h1>
    <div class="marquee">
      <span class="msg">En cliquant sur un article, vous serez automatiquement redirigé vers le site CNFANS&nbsp;&middot; Clicking on an article will automatically redirect you to the CNFANS website</span>
      <span class="msg">Attention, les prix affichés ne comprennent pas les frais de livraison&nbsp;&middot; Please note that the prices shown do not include delivery costs</span>
    </div>
  </header>

  <div class="social-banner">
    <!-- vos icônes sociales -->
  </div>

  <div class="filters">
    <select id="categoryFilter" onchange="filterProducts()">
      <option value="all">Catégories</option>
    </select>

    <select id="brandFilter" onchange="filterProducts()">
      <option value="all">Marques</option>
    </select>

    <select id="sortSelect" onchange="filterProducts()">
      <option value="none">Trier par</option>
      <option value="price-asc">Prix croissant</option>
      <option value="price-desc">Prix décroissant</option>
    </select>
  </div>

  <div class="grid" id="productGrid"></div>

  <script>
    let products = [], brands = [], colors = [], categories = [];

    // Charger catégories
    fetch('categories.json')
      .then(r => r.json())
      .then(data => {
        categories = data.sort((a,b) => a.localeCompare(b,'fr'));
        const cf = document.getElementById('categoryFilter');
        categories.forEach(c => {
          const o = document.createElement('option');
          o.value = o.textContent = c;
          cf.appendChild(o);
        });
      });

    // Charger marques
    fetch('brands.json')
      .then(r => r.json())
      .then(data => {
        brands = data.sort((a,b)=>a.localeCompare(b,'fr'));
        const bf = document.getElementById('brandFilter');
        brands.forEach(b => {
          const o = document.createElement('option');
          o.value = o.textContent = b;
          bf.appendChild(o);
        });
      });

    // Charger couleurs
    fetch('colors.json')
      .then(r=>r.json())
      .then(data=>colors = data)
      .catch(console.error);

    // Charger produits
    fetch('jadeship_products.json')
      .then(r=>r.json())
      .then(data=>{ products = data; filterProducts(); })
      .catch(console.error);

    function filterProducts(){
      const cat  = document.getElementById('categoryFilter').value;
      const br   = document.getElementById('brandFilter').value;
      const sort = document.getElementById('sortSelect').value;

      let filtered = products.filter(p =>
        (cat==='all'||p.category===cat) &&
        (br==='all'||p.brand===br)
      );

      if(sort==='price-asc')      filtered.sort((a,b)=>a.price - b.price);
      else if(sort==='price-desc') filtered.sort((a,b)=>b.price - a.price);

      displayProducts(filtered);
    }

    function displayProducts(list){
      const grid = document.getElementById('productGrid');
      grid.innerHTML = '';

      list.forEach(p => {
        const circles = (p.colors||[]).map(code =>
          `<span class="color-circle" style="background:${code}"></span>`
        ).join('');

        const card = document.createElement('a');
        card.className = 'product';
        card.href   = p.cnfans_link;
        card.target = '_blank';
        card.innerHTML = `
          <div class="product-brand">${p.brand}</div>
          <img src="${p.image}" alt="${p.title}">
          <div class="product-title">${p.title}</div>
          <div class="product-price">${p.price} €</div>
          <div class="product-colors">${circles}</div>
        `;
        grid.appendChild(card);
      });
    }
  </script>

</body>
</html>
